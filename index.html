<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>malllog - 1ë¶„ ì‡¼í˜¸ìŠ¤íŠ¸ ëŒ€ë³¸ ìƒì„±ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-blue-600">malllog</h1>
                        <p class="text-xs text-gray-500">1ë¶„ ì‡¼í˜¸ìŠ¤íŠ¸ ëŒ€ë³¸ ìƒì„±ê¸°</p>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#" id="nav-generator" class="text-blue-600 font-medium border-b-2 border-blue-600 px-3 py-2 text-sm">
                            <i class="fas fa-magic mr-2"></i>ëŒ€ë³¸ ìƒì„±
                        </a>
                        <a href="#" id="nav-library" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm">
                            <i class="fas fa-folder mr-2"></i>ë¼ì´ë¸ŒëŸ¬ë¦¬
                        </a>
                    </div>
                </nav>
                
                <!-- User Profile -->
                <div class="flex items-center">
                    <button id="google-login-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                        <i class="fab fa-google mr-2"></i>Google ë¡œê·¸ì¸
                    </button>
                    
                    <div id="user-profile" class="hidden flex items-center space-x-3">
                        <img id="user-avatar" src="" alt="User" class="w-8 h-8 rounded-full">
                        <span id="user-name" class="text-sm font-medium text-gray-900"></span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Generator View -->
        <div id="generator-view" class="space-y-8">
            <!-- Step 1: URL íŒŒì‹± -->
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center mb-6">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold mr-3">1</div>
                    <h2 class="text-xl font-semibold text-gray-900">ì—¬í–‰ ìƒí’ˆ URL ì…ë ¥</h2>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ìƒí’ˆ URL</label>
                        <div class="flex space-x-3">
                            <input type="url" id="url-input" placeholder="https://example.com/travel-product" 
                                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button id="parse-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium">
                                <i class="fas fa-search mr-2"></i>íŒŒì‹±
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Parsing Results -->
                <div id="parsing-empty" class="mt-6 text-center text-gray-500">
                    <i class="fas fa-link text-4xl mb-4"></i>
                    <p>URLì„ ì…ë ¥í•˜ê³  íŒŒì‹± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
                </div>
                
                <div id="parsing-loading" class="hidden mt-6 text-center">
                    <div class="inline-flex items-center">
                        <i class="fas fa-spinner fa-spin text-blue-600 mr-3"></i>
                        <span class="text-gray-700">ìƒí’ˆ ì •ë³´ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>
                    </div>
                </div>
                
                <div id="parsing-results" class="hidden mt-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-600 mr-2"></i>
                            <span class="text-green-800 font-medium">íŒŒì‹± ì™„ë£Œ</span>
                            <span class="ml-auto text-sm text-green-600">
                                ì‹ ë¢°ë„: <span id="confidence-score">85%</span>
                            </span>
                        </div>
                        <div class="mt-2 bg-green-200 rounded-full h-2">
                            <div id="confidence-bar" class="bg-green-600 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    
                    <div id="parsed-fields" class="space-y-3">
                        <!-- Parsed fields will be populated here -->
                    </div>
                    
                    <div class="mt-4 flex space-x-3">
                        <button id="edit-fields-btn" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium">
                            <i class="fas fa-edit mr-2"></i>í•„ë“œ ìˆ˜ì •
                        </button>
                        <button id="reset-btn" class="bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-lg font-medium">
                            <i class="fas fa-redo mr-2"></i>ì´ˆê¸°í™”
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Step 2: ëŒ€ë³¸ ì˜µì…˜ ì„¤ì • -->
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center mb-6">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold mr-3">2</div>
                    <h2 class="text-xl font-semibold text-gray-900">ëŒ€ë³¸ ì˜µì…˜ ì„¤ì •</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- ì§„í–‰ ë°©ì‹ -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">ì§„í–‰ ë°©ì‹</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="script-type" value="one_host" checked class="text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">1ì¸ ì§„í–‰</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="script-type" value="two_hosts" class="text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">2ì¸ ì§„í–‰</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- í†¤ì•¤ë§¤ë„ˆ -->
                    <div>
                        <label for="tone-select" class="block text-sm font-medium text-gray-700 mb-2">í†¤ì•¤ë§¤ë„ˆ</label>
                        <select id="tone-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="friendly">ì¹œê·¼í•œ</option>
                            <option value="trust">ì‹ ë¢°ê° ìˆëŠ”</option>
                            <option value="premium">í”„ë¦¬ë¯¸ì—„</option>
                        </select>
                    </div>
                    
                    <!-- íƒ€ê²Ÿ ê³ ê° -->
                    <div>
                        <label for="target-select" class="block text-sm font-medium text-gray-700 mb-2">íƒ€ê²Ÿ ê³ ê°</label>
                        <select id="target-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="golf">ê³¨í”„ ì—¬í–‰ê°</option>
                            <option value="leisure">íœ´ì–‘ ì—¬í–‰ê°</option>
                            <option value="package">íŒ¨í‚¤ì§€ ì—¬í–‰ê°</option>
                        </select>
                    </div>
                    
                    <!-- ëŒ€ë³¸ ê¸¸ì´ -->
                    <div>
                        <label for="duration-select" class="block text-sm font-medium text-gray-700 mb-2">ëŒ€ë³¸ ê¸¸ì´</label>
                        <select id="duration-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="55">55ì´ˆ</option>
                            <option value="60" selected>60ì´ˆ</option>
                            <option value="65">65ì´ˆ</option>
                            <option value="90">90ì´ˆ</option>
                        </select>
                    </div>
                    
                    <!-- í˜¸ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ -->
                    <div>
                        <label for="host-style-select" class="block text-sm font-medium text-gray-700 mb-2">í˜¸ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼</label>
                        <select id="host-style-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="passionate">ğŸ”¥ ì—´ì •ì  (í™ˆì‡¼í•‘)</option>
                            <option value="friendly">ğŸ˜Š ì¹œê·¼í•œ (ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤)</option>
                            <option value="professional">ğŸ’¼ ì „ë¬¸ì  (ì‹ ë¢°ê°)</option>
                        </select>
                    </div>
                    
                    <!-- êµ¬ì„± íƒ€ì… -->
                    <div>
                        <label for="structure-type-select" class="block text-sm font-medium text-gray-700 mb-2">êµ¬ì„± íƒ€ì…</label>
                        <select id="structure-type-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="basic">ğŸ“º ê¸°ë³¸í˜• (í™ˆì‡¼í•‘ êµ¬ì¡°)</option>
                            <option value="storytelling">ğŸ“– ìŠ¤í† ë¦¬í…”ë§í˜•</option>
                            <option value="viral">âš¡ ìˆí¼ ìµœì í™”í˜•</option>
                        </select>
                    </div>
                </div>
                
                <!-- í˜¸ìŠ¤íŠ¸ ì´ë¦„ ì„¤ì • (2ì¸ ì§„í–‰ ì‹œì—ë§Œ í‘œì‹œ) -->
                <div id="host-names-section" class="hidden mt-6 pt-6 border-t">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">í˜¸ìŠ¤íŠ¸ ì´ë¦„ ì„¤ì •</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="host1-name" class="block text-sm font-medium text-gray-700 mb-2">í˜¸ìŠ¤íŠ¸ 1</label>
                            <input type="text" id="host1-name" placeholder="ì§„í–‰ì1" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label for="host2-name" class="block text-sm font-medium text-gray-700 mb-2">í˜¸ìŠ¤íŠ¸ 2</label>
                            <input type="text" id="host2-name" placeholder="ì§„í–‰ì2" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 3: ëŒ€ë³¸ ìƒì„± -->
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center mb-6">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold mr-3">3</div>
                    <h2 class="text-xl font-semibold text-gray-900">ëŒ€ë³¸ ìƒì„±</h2>
                </div>
                
                <div class="text-center">
                    <button id="generate-script-btn" disabled 
                            class="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white px-8 py-3 rounded-lg font-medium text-lg">
                        <i class="fas fa-magic mr-2"></i>ëŒ€ë³¸ ìƒì„±í•˜ê¸°
                    </button>
                    <p class="text-sm text-gray-500 mt-2">URL íŒŒì‹± í›„ ëŒ€ë³¸ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                </div>
            </div>
            
            <!-- Script Results -->
            <div id="script-results-section" class="hidden bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">ìƒì„±ëœ ëŒ€ë³¸</h2>
                    
                    <!-- Tab Navigation -->
                    <div class="flex space-x-1 bg-gray-100 rounded-lg p-1">
                        <button id="tab-one-host" class="px-4 py-2 text-sm font-medium rounded-md border-blue-600 text-blue-600">
                            1ì¸ ì§„í–‰
                        </button>
                        <button id="tab-two-host" class="px-4 py-2 text-sm font-medium rounded-md border-transparent text-gray-500 hover:text-gray-700" style="display: none;">
                            2ì¸ ì§„í–‰
                        </button>
                    </div>
                </div>
                
                <!-- One Host Script -->
                <div id="one-host-content" class="space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-medium text-gray-900">1ì¸ ì§„í–‰ ëŒ€ë³¸</h3>
                        <div class="flex space-x-2">
                            <button id="play-one-host" class="bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-play mr-1"></i>ìŒì„± ì¬ìƒ
                            </button>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-copy mr-1"></i>ë³µì‚¬
                            </button>
                            <button class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-download mr-1"></i>ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                    <div id="one-host-script" class="bg-gray-50 p-4 rounded-lg font-mono text-sm whitespace-pre-wrap min-h-[200px]">
                        ëŒ€ë³¸ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                    </div>
                </div>
                
                <!-- Two Host Script -->
                <div id="two-host-content" class="hidden space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-medium text-gray-900">2ì¸ ì§„í–‰ ëŒ€ë³¸</h3>
                        <div class="flex space-x-2">
                            <button id="play-two-host" class="bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-play mr-1"></i>ìŒì„± ì¬ìƒ
                            </button>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-copy mr-1"></i>ë³µì‚¬
                            </button>
                            <button class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-download mr-1"></i>ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                    <div id="two-host-script" class="bg-gray-50 p-4 rounded-lg font-mono text-sm whitespace-pre-wrap min-h-[200px]">
                        ëŒ€ë³¸ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Library View -->
        <div id="library-view" class="hidden space-y-6">
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">ëŒ€ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
                    
                    <div class="flex space-x-4">
                        <input type="text" id="library-search" placeholder="ê²€ìƒ‰..." 
                               class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <select id="library-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">ì „ì²´</option>
                            <option value="draft">ì´ˆì•ˆ</option>
                            <option value="confirmed">í™•ì •</option>
                        </select>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìƒì„±ì¼</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìƒí’ˆëª…</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì‘ì„±ì</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìƒíƒœ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="library-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Library data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
    
    <!-- TTS Voice Control Panel -->
    <div id="voice-control-panel" class="hidden fixed bottom-4 right-4 bg-white rounded-lg shadow-lg border p-4 w-80">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-medium text-gray-900">ìŒì„± ì¬ìƒ</h3>
            <button id="close-voice-control" class="text-gray-400 hover:text-gray-600">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="space-y-4">
            <!-- Progress Bar -->
            <div class="space-y-2">
                <div class="flex justify-between text-sm text-gray-600">
                    <span id="current-time">00:00</span>
                    <span id="total-time">00:00</span>
                </div>
                <div class="bg-gray-200 rounded-full h-2">
                    <div id="progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="flex items-center justify-center space-x-4">
                <button id="voice-play-pause" class="bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center">
                    <i id="voice-play-icon" class="fas fa-play"></i>
                </button>
                <button id="voice-stop" class="bg-gray-500 hover:bg-gray-600 text-white w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-stop"></i>
                </button>
            </div>
            
            <!-- Voice Settings -->
            <div class="space-y-3">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ìŒì„± ì„ íƒ</label>
                    <select id="voice-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                        <option value="">ê¸°ë³¸ ìŒì„±</option>
                    </select>
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ì†ë„</label>
                        <input type="range" id="voice-rate" min="0.5" max="2" step="0.1" value="0.9" 
                               class="w-full">
                        <div class="text-xs text-gray-500 text-center">
                            <span id="rate-value">0.9x</span>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ìŒë†’ì´</label>
                        <input type="range" id="voice-pitch" min="0.5" max="2" step="0.1" value="1" 
                               class="w-full">
                        <div class="text-xs text-gray-500 text-center">
                            <span id="pitch-value">1.0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Current Text -->
            <div class="bg-gray-50 p-3 rounded-lg">
                <div class="text-xs text-gray-500 mb-1">í˜„ì¬ ì¬ìƒ ì¤‘</div>
                <div id="voice-current-text" class="text-sm text-gray-900">ìŒì„±ì„ ì¬ìƒí•˜ë ¤ë©´ ì¬ìƒ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</div>
            </div>
        </div>
    </div>
    
    <!-- Edit Fields Modal -->
    <div id="edit-fields-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">í•„ë“œ ìˆ˜ì •</h3>
                <button id="close-edit-modal" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="edit-fields-form" class="space-y-4">
                <!-- Form fields will be populated dynamically -->
            </form>
            
            <div class="flex justify-end space-x-3 mt-6">
                <button id="cancel-edit" class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg">
                    ì·¨ì†Œ
                </button>
                <button id="save-edit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg">
                    ì €ì¥
                </button>
            </div>
        </div>
    </div>
    
    <!-- Reset Modal -->
    <div id="reset-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <div class="flex items-center mb-4">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-lg font-semibold text-gray-900">ë°ì´í„° ì´ˆê¸°í™”</h3>
                    <p class="text-sm text-gray-600 mt-1">ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button id="cancel-reset" class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg">
                    ì·¨ì†Œ
                </button>
                <button id="confirm-reset" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg">
                    ì´ˆê¸°í™”
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
 <script>
// AIeoding - 1ë¶„ ì‡¼í˜¸ìŠ¤íŠ¸ ëŒ€ë³¸ ìƒì„±ê¸°
// Main Application JavaScript

class AIeodingApp {
    constructor() {
        this.currentUser = null;
        this.currentProduct = null;
        this.currentParsedData = null;
        this.currentView = 'generator';
        
        // TTS properties
        this.tts = {
            synth: window.speechSynthesis,
            utterance: null,
            isPlaying: false,
            isPaused: false,
            voices: [],
            currentScript: '',
            currentScriptType: 'one-host'
        };
        
        this.init();
    }

    init() {
        this.setupEventListeners();
        this.initTTS();
        this.loadMockUser(); // ì„ì‹œë¡œ ëª©ì—… ì‚¬ìš©ì ë¡œë“œ
        this.loadMockLibraryData();
    }

    setupEventListeners() {
        // Navigation
        document.getElementById('nav-generator').addEventListener('click', (e) => {
            e.preventDefault();
            this.switchView('generator');
        });
        
        document.getElementById('nav-library').addEventListener('click', (e) => {
            e.preventDefault();
            this.switchView('library');
        });

        // URL Parsing
        document.getElementById('parse-btn').addEventListener('click', () => {
            this.parseURL();
        });

        document.getElementById('reset-btn').addEventListener('click', () => {
            this.showResetModal();
        });

        // Script Type Change
        document.querySelectorAll('input[name="script-type"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                this.handleScriptTypeChange(e.target.value);
            });
        });

        // Generate Script
        document.getElementById('generate-script-btn').addEventListener('click', () => {
            this.generateScript();
        });

        // Tab Switching
        document.getElementById('tab-one-host').addEventListener('click', () => {
            this.switchScriptTab('one-host');
        });
        
        document.getElementById('tab-two-host').addEventListener('click', () => {
            this.switchScriptTab('two-host');
        });

        // Modal Handlers
        document.getElementById('edit-fields-btn').addEventListener('click', () => {
            this.showEditFieldsModal();
        });

        document.getElementById('close-edit-modal').addEventListener('click', () => {
            this.hideEditFieldsModal();
        });

        document.getElementById('cancel-edit').addEventListener('click', () => {
            this.hideEditFieldsModal();
        });

        document.getElementById('save-edit').addEventListener('click', () => {
            this.saveEditedFields();
        });

        // Reset Modal
        document.getElementById('cancel-reset').addEventListener('click', () => {
            this.hideResetModal();
        });

        document.getElementById('confirm-reset').addEventListener('click', () => {
            this.confirmReset();
        });

        // Library Search & Filter
        document.getElementById('library-search').addEventListener('input', (e) => {
            this.filterLibraryData(e.target.value);
        });

        document.getElementById('library-filter').addEventListener('change', (e) => {
            this.filterLibraryData();
        });

        // Copy & Download buttons
        this.setupCopyAndDownloadButtons();
        
        // TTS Controls
        this.setupTTSEventListeners();
    }

    // ì„ì‹œ ëª©ì—… ì‚¬ìš©ì ë¡œë“œ
    loadMockUser() {
        this.currentUser = {
            id: 'user-001',
            email: 'user@example.com',
            display_name: 'ê¹€ì—¬í–‰',
            photo_url: 'https://via.placeholder.com/32x32/4F46E5/FFFFFF?text=ê¹€',
            provider: 'google',
            role: 'owner',
            created_at: new Date().toISOString()
        };
        
        this.updateUserUI();
    }

    updateUserUI() {
        if (this.currentUser) {
            document.getElementById('google-login-btn').classList.add('hidden');
            document.getElementById('user-profile').classList.remove('hidden');
            document.getElementById('user-name').textContent = this.currentUser.display_name;
            document.getElementById('user-avatar').src = this.currentUser.photo_url;
        }
    }

    switchView(viewName) {
        this.currentView = viewName;
        
        // Update navigation
        document.getElementById('nav-generator').classList.remove('text-blue-600', 'font-medium', 'border-b-2', 'border-blue-600');
        document.getElementById('nav-generator').classList.add('text-gray-500', 'hover:text-gray-700');
        
        document.getElementById('nav-library').classList.remove('text-blue-600', 'font-medium', 'border-b-2', 'border-blue-600');
        document.getElementById('nav-library').classList.add('text-gray-500', 'hover:text-gray-700');
        
        // Show/hide views
        document.getElementById('generator-view').classList.add('hidden');
        document.getElementById('library-view').classList.add('hidden');
        
        if (viewName === 'generator') {
            document.getElementById('generator-view').classList.remove('hidden');
            document.getElementById('nav-generator').classList.remove('text-gray-500', 'hover:text-gray-700');
            document.getElementById('nav-generator').classList.add('text-blue-600', 'font-medium', 'border-b-2', 'border-blue-600');
        } else if (viewName === 'library') {
            document.getElementById('library-view').classList.remove('hidden');
            document.getElementById('nav-library').classList.remove('text-gray-500', 'hover:text-gray-700');
            document.getElementById('nav-library').classList.add('text-blue-600', 'font-medium', 'border-b-2', 'border-blue-600');
            this.loadLibraryData();
        }
    }

    async parseURL() {
        const urlInput = document.getElementById('url-input');
        const url = urlInput.value.trim();
        
        if (!url) {
            alert('URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        // Show loading state
        document.getElementById('parsing-empty').classList.add('hidden');
        document.getElementById('parsing-results').classList.add('hidden');
        document.getElementById('parsing-loading').classList.remove('hidden');

        // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì—¬ê¸°ì„œ API í˜¸ì¶œ
        // ëª©ì—… ë°ì´í„°ë¡œ ì‹œë®¬ë ˆì´ì…˜
        setTimeout(() => {
            this.simulateParsing(url);
        }, 2000);
    }

    simulateParsing(url) {
        // ëª©ì—… íŒŒì‹± ê²°ê³¼ ìƒì„±
        this.currentParsedData = {
            product_name: "ë² íŠ¸ë‚¨ ë‹¤ë‚­ 4ë°•5ì¼ ê³¨í”„ íŒ¨í‚¤ì§€",
            destination: "ë² íŠ¸ë‚¨ ë‹¤ë‚­",
            duration: "4ë°• 5ì¼",
            airline: "ë² íŠ¸ë‚¨í•­ê³µ",
            hotel: "í’€ë¨¼ ë‹¤ë‚­ ë¹„ì¹˜ ë¦¬ì¡°íŠ¸",
            golf_course: "ë‹¤ë‚­ ê³¨í”„í´ëŸ½",
            rounds: "2ë¼ìš´ë“œ",
            meals: "ì¡°ì‹ 4íšŒ, ì„ì‹ 2íšŒ",
            price: "1,890,000ì›",
            departure_dates: "2024ë…„ 3ì›” 15ì¼ ~ 4ì›” 30ì¼",
            includes: ["ì™•ë³µí•­ê³µë£Œ", "ìˆ™ë°•ë¹„", "ê³¨í”„í”¼", "ì¡°ì‹", "ê³µí•­ì„¸"],
            excludes: ["ê°œì¸ê²½ë¹„", "ì—¬í–‰ìë³´í—˜", "ì„ íƒê´€ê´‘"],
            perks: ["ê³¨í”„ìš©í’ˆ ë Œíƒˆ í• ì¸", "ìŠ¤íŒŒ 20% í• ì¸"],
            cautions: ["ì—¬ê¶Œ ìœ íš¨ê¸°ê°„ 6ê°œì›” ì´ìƒ", "ê³¨í”„ í•¸ë””ìº¡ ì¦ëª…ì„œ í•„ìš”"]
        };

        const confidence = 0.85;
        
        // Hide loading, show results
        document.getElementById('parsing-loading').classList.add('hidden');
        document.getElementById('parsing-results').classList.remove('hidden');
        
        // Update confidence score
        document.getElementById('confidence-score').textContent = Math.round(confidence * 100) + '%';
        document.getElementById('confidence-bar').style.width = Math.round(confidence * 100) + '%';
        
        // Populate parsed fields
        this.displayParsedFields();
        
        // Enable generate button
        document.getElementById('generate-script-btn').disabled = false;
        
        // Create mock product entry
        this.currentProduct = {
            id: 'product-' + Date.now(),
            source_url: url,
            parsed_fields: JSON.stringify(this.currentParsedData),
            parse_confidence: confidence,
            status: 'parsed',
            folder_id: null, // Will be created on script generation
            created_by: this.currentUser.id,
            created_at: new Date().toISOString()
        };
    }

    displayParsedFields() {
        const container = document.getElementById('parsed-fields');
        container.innerHTML = '';
        
        const fieldMappings = [
            { key: 'product_name', label: 'ìƒí’ˆëª…', icon: 'fas fa-tag' },
            { key: 'destination', label: 'ëª©ì ì§€', icon: 'fas fa-map-marker-alt' },
            { key: 'duration', label: 'ê¸°ê°„', icon: 'fas fa-calendar' },
            { key: 'airline', label: 'í•­ê³µì‚¬', icon: 'fas fa-plane' },
            { key: 'hotel', label: 'ìˆ™ë°•', icon: 'fas fa-hotel' },
            { key: 'golf_course', label: 'ê³¨í”„ì¥', icon: 'fas fa-golf-ball' },
            { key: 'rounds', label: 'ë¼ìš´ë“œ', icon: 'fas fa-golf-ball' },
            { key: 'price', label: 'ê°€ê²©', icon: 'fas fa-won-sign' }
        ];

        fieldMappings.forEach(field => {
            const value = this.currentParsedData[field.key];
            if (value) {
                const fieldElement = this.createParsedFieldElement(field.label, value, field.icon);
                container.appendChild(fieldElement);
            }
        });
    }

    createParsedFieldElement(label, value, icon) {
        const div = document.createElement('div');
        div.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
        
        div.innerHTML = `
            <div class="flex items-center space-x-3">
                <i class="${icon} text-blue-600"></i>
                <div>
                    <div class="text-sm font-medium text-gray-900">${label}</div>
                    <div class="text-sm text-gray-600">${value}</div>
                </div>
            </div>
            <div class="flex items-center">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    <i class="fas fa-check mr-1"></i>í™•ì¸ë¨
                </span>
            </div>
        `;
        
        return div;
    }

    handleScriptTypeChange(type) {
        const hostNamesSection = document.getElementById('host-names-section');
        
        if (type === 'two_hosts') {
            hostNamesSection.classList.remove('hidden');
        } else {
            hostNamesSection.classList.add('hidden');
        }

        // Update tab visibility
        const twoHostTab = document.getElementById('tab-two-host');
        if (type === 'two_hosts') {
            twoHostTab.style.display = 'block';
        } else {
            twoHostTab.style.display = 'none';
            // Switch to one host tab if currently on two host
            if (document.getElementById('two-host-content').classList.contains('block')) {
                this.switchScriptTab('one-host');
            }
        }
    }

    async generateScript() {
        if (!this.currentParsedData) {
            alert('ë¨¼ì € URLì„ íŒŒì‹±í•´ì£¼ì„¸ìš”.');
            return;
        }

        // Get options
        const scriptType = document.querySelector('input[name="script-type"]:checked').value;
        const tone = document.getElementById('tone-select').value;
        const target = document.getElementById('target-select').value;
        const duration = parseInt(document.getElementById('duration-select').value);
        
        const hostNames = {
            host1: document.getElementById('host1-name').value || 'ì§„í–‰ì1',
            host2: document.getElementById('host2-name').value || 'ì§„í–‰ì2'
        };

        // Show loading
        document.getElementById('generate-script-btn').disabled = true;
        document.getElementById('generate-script-btn').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>ìƒì„± ì¤‘...';

        try {
            await this.createMockScript(scriptType, tone, target, duration, hostNames);
        } catch (error) {
            console.error('Script generation error:', error);
            alert('ëŒ€ë³¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            
            // Reset generate button
            document.getElementById('generate-script-btn').disabled = false;
            document.getElementById('generate-script-btn').innerHTML = '<i class="fas fa-magic mr-2"></i>ëŒ€ë³¸ ìƒì„±í•˜ê¸°';
        }
    }

    async createMockScript(scriptType, tone, target, duration, hostNames) {
        try {
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            document.getElementById('generate-script-btn').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>AI ëŒ€ë³¸ ìƒì„± ì¤‘...';
            
            // 1ì¸ ì§„í–‰ ëŒ€ë³¸ ìƒì„±
            const oneHostScript = this.generateOneHostScript();
            
            // 2ì¸ ì§„í–‰ ëŒ€ë³¸ ìƒì„±
            const twoHostScript = this.generateTwoHostScript(hostNames);
            
            // Create folder and save script
            await this.createFolderAndSaveScript(scriptType, { oneHostScript, twoHostScript }, duration);
        
        // Show results
        document.getElementById('script-results-section').classList.remove('hidden');
        document.getElementById('one-host-script').textContent = oneHostScript;
        document.getElementById('two-host-script').textContent = twoHostScript;
        
        // Reset generate button
        document.getElementById('generate-script-btn').disabled = false;
        document.getElementById('generate-script-btn').innerHTML = '<i class="fas fa-magic mr-2"></i>ëŒ€ë³¸ ìƒì„±í•˜ê¸°';
        
        // Auto-switch to appropriate tab
        if (scriptType === 'two_hosts') {
            this.switchScriptTab('two-host');
        } else {
            this.switchScriptTab('one-host');
        }

        // Scroll to results
        document.getElementById('script-results-section').scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
            console.error('Script generation error:', error);
            
            // Reset generate button
            document.getElementById('generate-script-btn').disabled = false;
            document.getElementById('generate-script-btn').innerHTML = '<i class="fas fa-magic mr-2"></i>ëŒ€ë³¸ ìƒì„±í•˜ê¸°';
            
            alert('ëŒ€ë³¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
    }

    generateOneHostScript() {
        const data = this.currentParsedData;
        const tone = document.getElementById('tone-select').value;
        const target = document.getElementById('target-select').value;
        const hostStyle = document.getElementById('host-style-select').value;
        const structureType = document.getElementById('structure-type-select').value;
        const duration = parseInt(document.getElementById('duration-select').value);
        
        return this.getShoppingHostTemplate(data, tone, target, hostStyle, 'one_host', null);
    }

    generateTwoHostScript(hostNames) {
        const data = this.currentParsedData;
        const tone = document.getElementById('tone-select').value;
        const target = document.getElementById('target-select').value;
        const hostStyle = document.getElementById('host-style-select').value;
        const structureType = document.getElementById('structure-type-select').value;
        const duration = parseInt(document.getElementById('duration-select').value);
        
        return this.getShoppingHostTemplate(data, tone, target, hostStyle, 'two_hosts', hostNames);
    }

    getShoppingHostTemplate(data, tone, target, hostStyle, scriptType, hostNames = null) {
        const structureType = document.getElementById('structure-type-select').value;
        const templates = {
            passionate: { // ğŸ”¥ ì—´ì •ì  í™ˆì‡¼í•‘ ìŠ¤íƒ€ì¼
                one_host: {
                    intro: "ì—¬ëŸ¬ë¶„ ì•ˆë…•í•˜ì„¸ìš”! ì™€, ì˜¤ëŠ˜ ì •ë§ ë†€ë¼ìš´ ì—¬í–‰ ìƒí’ˆ í•˜ë‚˜ ê°€ì ¸ì™”ì–´ìš”!",
                    core: "ì§€ê¸ˆ ë³´ê³  ê³„ì‹  ê²Œ ë°”ë¡œ {destination} {duration}! ì–´ë¨¸ ì´ê±´ ì§„ì§œ ëŒ€ë°•ì´ì—ìš”! {golf_course}ì—ì„œ {rounds}ë¥¼ ì¹˜ì‹¤ ìˆ˜ ìˆë‹¤ê³ ìš”? ì´ ê°€ê²©ì—?",
                    hotel: "ê·¸ëŸ°ë° ì—¬ëŸ¬ë¶„, ì—¬ê¸°ì„œ ëì´ ì•„ë‹ˆì—ìš”! ìˆ™ë°•ì€ ì–´ë””ëƒêµ¬ìš”? {hotel}ì´ì—ìš”! ì–´ë¨¸ ì´ í˜¸í…” ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ì•„ì„¸ìš”? {meals}ê¹Œì§€ ë‹¤ í¬í•¨ì´ë¼ê³ ìš”!",
                    flight: "í•­ê³µí¸ë„ ì™„ì „ ëŸ­ì…”ë¦¬í•´ìš”! {airline}ìœ¼ë¡œ í¸ì•ˆ~í•˜ê²Œ ê°€ì‹œê³ ìš”, {departure_dates} ì¤‘ì— ì–¸ì œë“ ì§€ ì¶œë°œí•˜ì‹¤ ìˆ˜ ìˆì–´ìš”! ì´ê±´ ì§„ì§œ ê¸°íšŒì˜ˆìš”!",
                    price: "ê·¸ëŸ°ë° ê°€ê²©ì´ ì–¼ë§ˆì¼ ê²ƒ ê°™ìœ¼ì„¸ìš”? {includes} ì´ ëª¨ë“  ê²Œ ë‹¤ í¬í•¨ë˜ì–´ì„œ... ì–´ë¨¸ ê¹œì§ ë†€ë¼ì§€ ë§ˆì„¸ìš”... ë‹¨ëˆ {price}! ë§ë„ ì•ˆ ë˜ëŠ” ê°€ê²©ì´ì£ ?",
                    perks: "ì•„ì§ë„ ë” ìˆì–´ìš”! íŠ¹ë³„ í˜œíƒìœ¼ë¡œ {perks} ì´ëŸ° ê²ƒë„ ë‹¤ ë“œë¦°ë‹¤ê³ ìš”! í•˜ì§€ë§Œ {cautions} ì´ê±´ ê¼­ ë¯¸ë¦¬ ì¤€ë¹„í•´ì£¼ì„¸ìš”!",
                    ending: "ì—¬ëŸ¬ë¶„, ì´ëŸ° ê¸°íšŒëŠ” ì •ë§ í”í•˜ì§€ ì•Šì•„ìš”! ì§€ê¸ˆ ë°”ë¡œ ì•„ë˜ ë§í¬ í´ë¦­í•˜ì„¸ìš”!"
                },
                two_hosts: {
                    intro: "{host1}: ì—¬ëŸ¬ë¶„ ì•ˆë…•í•˜ì„¸ìš”! {host1}ì…ë‹ˆë‹¤!\n{host2}: {host2}ì˜ˆìš”! ì˜¤ëŠ˜ ì§„ì§œ ëŒ€ë°• ìƒí’ˆ ê°€ì ¸ì™”ì–´ìš”!",
                    core: "{host1}: ì™€ {host2}ì”¨, ì´ê±° ì§„ì§œ ëŒ€ë‹¨í•œë°ìš”?\n{host2}: ë§ì•„ìš”! {destination} {duration}ì¸ë°, {golf_course}ì—ì„œ {rounds}ë¥¼ ì¹œë‹¤ê³ ìš”!",
                    hotel: "{host1}: ìˆ™ë°•ì€ ì–´ë””ì„œ í•˜ëŠ” ê±°ì˜ˆìš”?\n{host2}: ì–´ë¨¸, {hotel}ì´ì—ìš”! ì´ í˜¸í…”ì´ ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€! {meals}ê¹Œì§€ ë‹¤ í¬í•¨ì´ë˜ìš”!",
                    flight: "{host1}: í•­ê³µí¸ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?\n{host2}: {airline}ìœ¼ë¡œ ì™„ì „ í¸ì•ˆí•˜ê²Œ! {departure_dates} ì¤‘ì— ì–¸ì œë“  ì¶œë°œ ê°€ëŠ¥í•´ìš”!",
                    price: "{host1}: ê°€ê²©ì´ ê¶ê¸ˆí•œë°ìš”?\n{host2}: ê¹œì§ ë†€ë¼ì§€ ë§ˆì„¸ìš”! {includes} ë‹¤ í¬í•¨í•´ì„œ {price}! ë§ë„ ì•ˆ ë˜ì£ ?",
                    perks: "{host1}: í˜œíƒë„ ë” ìˆë‚˜ìš”?\n{host2}: ë‹¹ì—°í•˜ì£ ! {perks} ì´ëŸ° ê²ƒë„ ë‹¤ ë“œë ¤ìš”! ë‹¨, {cautions} ì´ê±´ ê¼­ í™•ì¸í•˜ì„¸ìš”!",
                    ending: "{host1}: ì´ëŸ° ê¸°íšŒëŠ” ì •ë§ í”í•˜ì§€ ì•Šì•„ìš”!\n{host2}: ì§€ê¸ˆ ë°”ë¡œ ì•„ë˜ ë§í¬ í´ë¦­í•˜ì„¸ìš”!"
                }
            },
            friendly: { // ğŸ˜Š ì¹œê·¼í•œ ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤ ìŠ¤íƒ€ì¼
                one_host: {
                    intro: "ì•ˆë…•í•˜ì„¸ìš” ì—¬ëŸ¬ë¶„~ ì˜¤ëŠ˜ë„ ì¢‹ì€ ì—¬í–‰ ìƒí’ˆìœ¼ë¡œ ì°¾ì•„ì™”ì–´ìš”!",
                    core: "{destination} {duration} ì–´ë– ì„¸ìš”? ì •ë§ ì¢‹ì§€ ì•Šë‚˜ìš”? {golf_course}ì—ì„œ {rounds} ì¹˜ë©´ì„œ íë§í•˜ëŠ” ê±°ì˜ˆìš”!",
                    hotel: "ìˆ™ë°•ì€ {hotel}ì—ì„œ í•˜ì‹œê³ ìš”, {meals}ë„ ë§›ìˆê²Œ ë“œì‹¤ ìˆ˜ ìˆì–´ìš”! ì§„ì§œ í¸í•˜ê²Œ ì‰¬ë‹¤ ì˜¤ì‹¤ ìˆ˜ ìˆì–´ìš”~",
                    flight: "{airline}ìœ¼ë¡œ ì•ˆì „í•˜ê³  í¸ë¦¬í•˜ê²Œ ê°€ì‹œë©´ ë˜ê³ ìš”, {departure_dates} ì¤‘ì— ì›í•˜ì‹œëŠ” ë‚ ì§œë¡œ ê³¨ë¼ì„œ ê°€ì„¸ìš”!",
                    price: "ê·¸ë¦¬ê³  ê°€ê²©ë„ ì •ë§ í•©ë¦¬ì ì´ì—ìš”! {includes} ì´ëŸ° ê²ƒë“¤ ë‹¤ í¬í•¨í•´ì„œ {price}ë°–ì— ì•ˆ í•´ìš”! ì§„ì§œ ê´œì°®ì£ ?",
                    perks: "íŠ¹ë³„íˆ {perks} ì´ëŸ° í˜œíƒë“¤ë„ ë“œë¦¬ê³  ìˆì–´ìš”! ì•„, ê·¸ë¦¬ê³  {cautions} ì´ê±´ ë¯¸ë¦¬ ì²´í¬í•´ì£¼ì„¸ìš”!",
                    ending: "ì–´ë– ì„¸ìš”? ë§ˆìŒì— ë“œì‹œì£ ? ê·¸ëŸ¼ ë°”ë¡œ ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!"
                },
                two_hosts: {
                    intro: "{host1}: ì•ˆë…•í•˜ì„¸ìš”~ {host1}ì´ì—ìš”!\n{host2}: {host2}ì…ë‹ˆë‹¤! ì˜¤ëŠ˜ ì •ë§ ì¢‹ì€ ì—¬í–‰ ìƒí’ˆ ì¤€ë¹„í–ˆì–´ìš”!",
                    core: "{host1}: {destination} ì—¬í–‰ ì–´ë•Œìš”?\n{host2}: ì¢‹ì£ ! {golf_course}ì—ì„œ {rounds} ì¹˜ë©´ì„œ íë§í•˜ëŠ” ê±°ì˜ˆìš”!",
                    hotel: "{host1}: ì–´ë””ì„œ ìˆ™ë°•í•˜ë‚˜ìš”?\n{host2}: {hotel}ì—ì„œ í•˜ì‹œê³ , {meals}ë„ ë§›ìˆê²Œ ë“œì‹¤ ìˆ˜ ìˆì–´ìš”!",
                    flight: "{host1}: í•­ê³µí¸ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?\n{host2}: {airline}ìœ¼ë¡œ í¸ë¦¬í•˜ê²Œ! {departure_dates} ì¤‘ì— ê³¨ë¼ì„œ ê°€ì„¸ìš”!",
                    price: "{host1}: ê°€ê²©ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?\n{host2}: {includes} ë‹¤ í¬í•¨í•´ì„œ {price}! ì •ë§ í•©ë¦¬ì ì´ì£ ?",
                    perks: "{host1}: ë‹¤ë¥¸ í˜œíƒë„ ìˆë‚˜ìš”?\n{host2}: ë„¤! {perks} ì´ëŸ° ê²ƒë“¤ë„ ë“œë ¤ìš”! {cautions} ì´ê±´ ì²´í¬í•´ì£¼ì„¸ìš”!",
                    ending: "{host1}: ì–´ë– ì„¸ìš”? ë§ˆìŒì— ë“œì‹œë‚˜ìš”?\n{host2}: ê·¸ëŸ¼ ë°”ë¡œ ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!"
                }
            },
            professional: { // ğŸ’¼ ì „ë¬¸ì +ì¬ë¯¸ìˆëŠ” ìŠ¤íƒ€ì¼
                one_host: {
                    intro: "ì•ˆë…•í•˜ì„¸ìš”! ì—¬í–‰ ì „ë¬¸ê°€ê°€ ì—„ì„ í•œ íŠ¹ë³„í•œ ìƒí’ˆì„ ì†Œê°œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
                    core: "{destination} {duration} í”„ë¦¬ë¯¸ì—„ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. {golf_course}ì—ì„œì˜ {rounds}, ì´ê±´ ì •ë§ íŠ¹ë³„í•œ ê²½í—˜ì´ ë  ê±°ì˜ˆìš”.",
                    hotel: "ìˆ™ë°• ì‹œì„¤ë¡œëŠ” {hotel}ì„ ì„ ì •í–ˆìŠµë‹ˆë‹¤. {meals} ì„œë¹„ìŠ¤ì™€ í•¨ê»˜ ìµœìƒì˜ ì»´í¬íŠ¸ë¥¼ ì œê³µí•´ë“œë ¤ìš”.",
                    flight: "í•­ê³µí¸ì€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” {airline}ì„ ì´ìš©í•˜ì‹œê³ , {departure_dates} ê¸°ê°„ ì¤‘ ìœ ì—°í•˜ê²Œ ì¶œë°œ ì¼ì •ì„ ì¡ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    price: "ì´ ëª¨ë“  ì„œë¹„ìŠ¤, {includes}ë¥¼ í¬í•¨í•œ íŒ¨í‚¤ì§€ ê°€ê²©ì´ {price}ì…ë‹ˆë‹¤. ê°€ì„±ë¹„ ì¸¡ë©´ì—ì„œ ì •ë§ í›Œë¥­í•œ ì„ íƒì´ì£ .",
                    perks: "ì¶”ê°€ë¡œ {perks} ë“±ì˜ í”„ë¦¬ë¯¸ì—„ í˜œíƒë„ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ {cautions} ì‚¬ì „ ì¤€ë¹„ì‚¬í•­ì€ ê¼­ í™•ì¸í•´ì£¼ì„¸ìš”.",
                    ending: "ì „ë¬¸ê°€ê°€ ì¶”ì²œí•˜ëŠ” ì´ íŠ¹ë³„í•œ ì—¬í–‰, ë†“ì¹˜ì§€ ë§ˆì‹œê³  ì§€ê¸ˆ ë°”ë¡œ í™•ì¸í•´ë³´ì„¸ìš”!"
                },
                two_hosts: {
                    intro: "{host1}: ì•ˆë…•í•˜ì„¸ìš”, ì—¬í–‰ ì „ë¬¸ê°€ {host1}ì…ë‹ˆë‹¤.\n{host2}: {host2}ì…ë‹ˆë‹¤. ì˜¤ëŠ˜ ì •ë§ íŠ¹ë³„í•œ ìƒí’ˆì„ ì¤€ë¹„í–ˆì–´ìš”.",
                    core: "{host1}: {destination} íŒ¨í‚¤ì§€êµ°ìš”?\n{host2}: ë„¤, {golf_course}ì—ì„œì˜ {rounds}ëŠ” ì •ë§ í”„ë¦¬ë¯¸ì—„ ê²½í—˜ì´ì—ìš”.",
                    hotel: "{host1}: ìˆ™ë°•ì€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ë‚˜ìš”?\n{host2}: {hotel}ì—ì„œ {meals} ì„œë¹„ìŠ¤ì™€ í•¨ê»˜ ìµœìƒì˜ íœ´ì‹ì„ ì œê³µí•©ë‹ˆë‹¤.",
                    flight: "{host1}: í•­ê³µí¸ ì •ë³´ë„ ì•Œë ¤ì£¼ì„¸ìš”.\n{host2}: {airline} ì´ìš©ìœ¼ë¡œ {departure_dates} ì¤‘ ìœ ì—°í•œ ì¶œë°œì´ ê°€ëŠ¥í•´ìš”.",
                    price: "{host1}: íˆ¬ì ê°€ì¹˜ëŠ” ì–´ë–»ê²Œ ë³´ì‹œë‚˜ìš”?\n{host2}: {includes} í¬í•¨ {price}, ê°€ì„±ë¹„ ë©´ì—ì„œ ì •ë§ íƒì›”í•©ë‹ˆë‹¤.",
                    perks: "{host1}: ì¶”ê°€ í˜œíƒë„ ìˆë‚˜ìš”?\n{host2}: {perks} ë“± í”„ë¦¬ë¯¸ì—„ í˜œíƒì´ ìˆê³ , {cautions} ì‚¬ì „ ì¤€ë¹„ëŠ” í•„ìˆ˜ì˜ˆìš”.",
                    ending: "{host1}: ì „ë¬¸ê°€ ì¶”ì²œ ìƒí’ˆì´êµ°ìš”.\n{host2}: ë„¤, ì§€ê¸ˆ ë°”ë¡œ í™•ì¸í•´ë³´ì‹œê¸¸ ì¶”ì²œë“œë ¤ìš”!"
                }
            }
        };

        const selectedTemplate = templates[hostStyle] || templates.passionate;
        const styleTemplate = selectedTemplate[scriptType] || selectedTemplate.one_host;
        
        // ëŒ€ë³¸ ê¸¸ì´ì— ë”°ë¥¸ ì‹œê°„ êµ¬ê°„ ì„¤ì •
        const duration = parseInt(document.getElementById('duration-select').value) || 60;
        let sections = [];

        // ê¸°ë³¸í˜• êµ¬ì¡° ì‚¬ìš©
        if (duration === 90) {
            sections = [
                { time: "00:00-00:13", title: "ì¸íŠ¸ë¡œ", content: styleTemplate.intro },
                { time: "00:13-00:26", title: "ìƒí’ˆ í•µì‹¬", content: styleTemplate.core },
                { time: "00:26-00:39", title: "ìˆ™ë°•&í¸ì˜", content: styleTemplate.hotel },
                { time: "00:39-00:52", title: "í•­ê³µ&ì¡°ê±´", content: styleTemplate.flight },
                { time: "00:52-01:05", title: "í¬í•¨&ê°€ê²©", content: styleTemplate.price },
                { time: "01:05-01:18", title: "íŠ¹ì „ ë° ìœ ì˜", content: styleTemplate.perks },
                { time: "01:18-01:30", title: "ì—”ë”©", content: styleTemplate.ending }
            ];
        } else {
            sections = [
                { time: "00:00-00:08", title: "ì¸íŠ¸ë¡œ", content: styleTemplate.intro },
                { time: "00:08-00:18", title: "ìƒí’ˆ í•µì‹¬", content: styleTemplate.core },
                { time: "00:18-00:28", title: "ìˆ™ë°•&í¸ì˜", content: styleTemplate.hotel },
                { time: "00:28-00:38", title: "í•­ê³µ&ì¡°ê±´", content: styleTemplate.flight },
                { time: "00:38-00:48", title: "í¬í•¨&ê°€ê²©", content: styleTemplate.price },
                { time: "00:48-00:55", title: "íŠ¹ì „ ë° ìœ ì˜", content: styleTemplate.perks },
                { time: "00:55-01:00", title: "ì—”ë”©", content: styleTemplate.ending }
            ];
        }

        return sections.map(section => {
            let content = section.content;
            
            // ë°ì´í„° ì¹˜í™˜
            Object.entries(data).forEach(([key, value]) => {
                const placeholder = `{${key}}`;
                if (Array.isArray(value)) {
                    content = content.replace(new RegExp(placeholder.replace(/[{}]/g, '\\$&'), 'g'), value.slice(0, 3).join(', '));
                } else {
                    content = content.replace(new RegExp(placeholder.replace(/[{}]/g, '\\$&'), 'g'), value || '');
                }
            });

            // í˜¸ìŠ¤íŠ¸ ì´ë¦„ ì¹˜í™˜ (2ì¸ ì§„í–‰ìš©)
            if (hostNames) {
                content = content.replace(/{host1}/g, hostNames.host1 || 'ì§„í–‰ì1');
                content = content.replace(/{host2}/g, hostNames.host2 || 'ì§„í–‰ì2');
            }

            return `[${section.time}] ${section.title}\n${content}`;
        }).join('\n\n');
    }

    async createFolderAndSaveScript(scriptType, scripts, duration) {
        // Mock implementation
        console.log('Saving script:', { scriptType, scripts, duration });
        await new Promise(resolve => setTimeout(resolve, 1000));
    }

    switchScriptTab(tabName) {
        // Update tab buttons
        document.getElementById('tab-one-host').classList.remove('border-blue-600', 'text-blue-600');
        document.getElementById('tab-one-host').classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700');
        
        document.getElementById('tab-two-host').classList.remove('border-blue-600', 'text-blue-600');
        document.getElementById('tab-two-host').classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700');

        // Hide all contents
        document.getElementById('one-host-content').classList.add('hidden');
        document.getElementById('two-host-content').classList.add('hidden');

        // Show selected content
        if (tabName === 'one-host') {
            document.getElementById('tab-one-host').classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700');
            document.getElementById('tab-one-host').classList.add('border-blue-600', 'text-blue-600');
            document.getElementById('one-host-content').classList.remove('hidden');
        } else if (tabName === 'two-host') {
            document.getElementById('tab-two-host').classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700');
            document.getElementById('tab-two-host').classList.add('border-blue-600', 'text-blue-600');
            document.getElementById('two-host-content').classList.remove('hidden');
        }
    }

    showEditFieldsModal() {
        if (!this.currentParsedData) return;
        
        const form = document.getElementById('edit-fields-form');
        form.innerHTML = '';
        
        Object.entries(this.currentParsedData).forEach(([key, value]) => {
            if (typeof value === 'string') {
                const fieldDiv = document.createElement('div');
                fieldDiv.innerHTML = `
                    <label class="block text-sm font-medium text-gray-700 mb-1">${this.getFieldLabel(key)}</label>
                    <input 
                        type="text" 
                        id="edit-${key}" 
                        value="${value}" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                `;
                form.appendChild(fieldDiv);
            }
        });
        
        document.getElementById('edit-fields-modal').classList.remove('hidden');
    }

    getFieldLabel(key) {
        const labels = {
            product_name: 'ìƒí’ˆëª…',
            destination: 'ëª©ì ì§€',
            duration: 'ê¸°ê°„',
            airline: 'í•­ê³µì‚¬',
            hotel: 'ìˆ™ë°•',
            golf_course: 'ê³¨í”„ì¥',
            rounds: 'ë¼ìš´ë“œ',
            meals: 'ì‹ì‚¬',
            price: 'ê°€ê²©',
            departure_dates: 'ì¶œë°œì¼'
        };
        return labels[key] || key;
    }

    hideEditFieldsModal() {
        document.getElementById('edit-fields-modal').classList.add('hidden');
    }

    saveEditedFields() {
        const form = document.getElementById('edit-fields-form');
        const inputs = form.querySelectorAll('input');
        
        inputs.forEach(input => {
            const key = input.id.replace('edit-', '');
            this.currentParsedData[key] = input.value;
        });
        
        this.displayParsedFields();
        this.hideEditFieldsModal();
    }

    showResetModal() {
        document.getElementById('reset-modal').classList.remove('hidden');
    }

    hideResetModal() {
        document.getElementById('reset-modal').classList.add('hidden');
    }

    confirmReset() {
        // Reset all data
        this.currentProduct = null;
        this.currentParsedData = null;
        
        // Reset UI
        document.getElementById('url-input').value = '';
        document.getElementById('parsing-results').classList.add('hidden');
        document.getElementById('parsing-empty').classList.remove('hidden');
        document.getElementById('script-results-section').classList.add('hidden');
        document.getElementById('generate-script-btn').disabled = true;
        
        // Reset form
        document.querySelector('input[name="script-type"][value="one_host"]').checked = true;
        document.getElementById('tone-select').value = 'friendly';
        document.getElementById('target-select').value = 'golf';
        document.getElementById('duration-select').value = '60';
        document.getElementById('host1-name').value = '';
        document.getElementById('host2-name').value = '';
        document.getElementById('host-names-section').classList.add('hidden');
        
        this.hideResetModal();
        
        alert('ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    setupCopyAndDownloadButtons() {
        // Copy buttons
        document.querySelectorAll('button').forEach(btn => {
            if (btn.innerHTML.includes('ë³µì‚¬')) {
                btn.addEventListener('click', (e) => {
                    const content = e.target.closest('.space-y-6').querySelector('div[id$="-script"]').textContent;
                    navigator.clipboard.writeText(content).then(() => {
                        const originalText = e.target.innerHTML;
                        e.target.innerHTML = '<i class="fas fa-check mr-1"></i>ë³µì‚¬ë¨';
                        setTimeout(() => {
                            e.target.innerHTML = originalText;
                        }, 2000);
                    });
                });
            }
            
            if (btn.innerHTML.includes('ë‹¤ìš´ë¡œë“œ')) {
                btn.addEventListener('click', (e) => {
                    const content = e.target.closest('.space-y-6').querySelector('div[id$="-script"]').textContent;
                    const type = e.target.closest('.space-y-6').id.includes('one-host') ? '1ì¸ì§„í–‰' : '2ì¸ì§„í–‰';
                    const fileName = `${this.currentParsedData?.product_name || 'ëŒ€ë³¸'}_${type}.txt`;
                    
                    const blob = new Blob([content], { type: 'text/plain' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    a.click();
                    URL.revokeObjectURL(url);
                });
            }
        });
    }

    // Library functions
    loadMockLibraryData() {
        this.libraryData = [
            {
                id: 'folder-001',
                created_at: '2024-03-20',
                product_name: 'íƒœêµ­ í‘¸ì¼“ 3ë°•4ì¼ ê³¨í”„ íŒ¨í‚¤ì§€',
                author: 'ê¹€ì—¬í–‰',
                status: 'confirmed'
            },
            {
                id: 'folder-002', 
                created_at: '2024-03-18',
                product_name: 'ì¼ë³¸ ì˜¤í‚¤ë‚˜ì™€ 4ë°•5ì¼ ë¦¬ì¡°íŠ¸',
                author: 'ì´ì—¬í–‰',
                status: 'draft'
            },
            {
                id: 'folder-003',
                created_at: '2024-03-15',
                product_name: 'ë² íŠ¸ë‚¨ ë‹¤ë‚­ 5ë°•6ì¼ ê³¨í”„&íœ´ì–‘',
                author: 'ê¹€ì—¬í–‰',
                status: 'confirmed'
            }
        ];
    }

    loadLibraryData() {
        const tbody = document.getElementById('library-table-body');
        tbody.innerHTML = '';
        
        this.libraryData.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50 cursor-pointer';
            
            const statusClass = item.status === 'confirmed' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';
            const statusText = item.status === 'confirmed' ? 'í™•ì •' : 'ì´ˆì•ˆ';
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.created_at}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-gray-900">${item.product_name}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.author}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                        ${statusText}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button class="text-blue-600 hover:text-blue-900 mr-3">ë³´ê¸°</button>
                    <button class="text-gray-600 hover:text-gray-900">ì‚­ì œ</button>
                </td>
            `;
            
            tbody.appendChild(row);
        });
    }

    filterLibraryData(searchTerm = '') {
        const searchValue = searchTerm || document.getElementById('library-search').value.toLowerCase();
        const filterValue = document.getElementById('library-filter').value;
        
        let filteredData = this.libraryData.filter(item => {
            const matchesSearch = searchValue === '' || 
                item.product_name.toLowerCase().includes(searchValue) ||
                item.author.toLowerCase().includes(searchValue);
            
            const matchesFilter = filterValue === '' || item.status === filterValue;
            
            return matchesSearch && matchesFilter;
        });
        
        // Update table with filtered data
        const tbody = document.getElementById('library-table-body');
        tbody.innerHTML = '';
        
        filteredData.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50 cursor-pointer';
            
            const statusClass = item.status === 'confirmed' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';
            const statusText = item.status === 'confirmed' ? 'í™•ì •' : 'ì´ˆì•ˆ';
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.created_at}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-gray-900">${item.product_name}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.author}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                        ${statusText}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button class="text-blue-600 hover:text-blue-900 mr-3">ë³´ê¸°</button>
                    <button class="text-gray-600 hover:text-gray-900">ì‚­ì œ</button>
                </td>
            `;
            
            tbody.appendChild(row);
        });
    }

    // TTS Methods
    initTTS() {
        // Load available voices
        if (this.tts.synth) {
            this.loadVoices();
            
            // Voice loading can be asynchronous
            if (this.tts.synth.onvoiceschanged !== undefined) {
                this.tts.synth.onvoiceschanged = () => {
                    this.loadVoices();
                };
            }
        }
    }

    loadVoices() {
        this.tts.voices = this.tts.synth.getVoices();
        const voiceSelect = document.getElementById('voice-select');
        
        if (voiceSelect && this.tts.voices.length > 0) {
            voiceSelect.innerHTML = '';
            
            // Filter Korean voices first, then others
            const koreanVoices = this.tts.voices.filter(voice => 
                voice.lang.includes('ko') || voice.name.includes('Korean')
            );
            const otherVoices = this.tts.voices.filter(voice => 
                !voice.lang.includes('ko') && !voice.name.includes('Korean')
            );
            
            // Add Korean voices
            if (koreanVoices.length > 0) {
                const koreanGroup = document.createElement('optgroup');
                koreanGroup.label = 'í•œêµ­ì–´ ìŒì„±';
                koreanVoices.forEach((voice, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    koreanGroup.appendChild(option);
                });
                voiceSelect.appendChild(koreanGroup);
            }
            
            // Add other voices
            if (otherVoices.length > 0) {
                const otherGroup = document.createElement('optgroup');
                otherGroup.label = 'ê¸°íƒ€ ìŒì„±';
                otherVoices.forEach((voice, index) => {
                    const option = document.createElement('option');
                    option.value = koreanVoices.length + index;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    otherGroup.appendChild(option);
                });
                voiceSelect.appendChild(otherGroup);
            }
            
            // Set default to first Korean voice or first available
            if (koreanVoices.length > 0) {
                voiceSelect.value = 0;
            } else if (this.tts.voices.length > 0) {
                voiceSelect.value = 0;
            }
        }
    }

    setupTTSEventListeners() {
        // Play buttons
        document.getElementById('play-one-host')?.addEventListener('click', () => {
            this.playScript('one-host');
        });
        
        document.getElementById('play-two-host')?.addEventListener('click', () => {
            this.playScript('two-host');
        });
        
        // Voice control panel
        document.getElementById('voice-play-pause')?.addEventListener('click', () => {
            this.togglePlayPause();
        });
        
        document.getElementById('voice-stop')?.addEventListener('click', () => {
            this.stop();
        });
        
        document.getElementById('close-voice-control')?.addEventListener('click', () => {
            this.hideVoiceControl();
            this.stop();
        });
        
        // Voice settings
        document.getElementById('voice-rate')?.addEventListener('input', (e) => {
            document.getElementById('rate-value').textContent = e.target.value + 'x';
        });
        
        document.getElementById('voice-pitch')?.addEventListener('input', (e) => {
            document.getElementById('pitch-value').textContent = parseFloat(e.target.value).toFixed(1);
        });
    }

    playScript(scriptType) {
        const scriptContent = scriptType === 'one-host' 
            ? document.getElementById('one-host-script').textContent
            : document.getElementById('two-host-script').textContent;
            
        if (!scriptContent.trim()) {
            alert('ë¨¼ì € ëŒ€ë³¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”.');
            return;
        }
        
        this.tts.currentScript = this.cleanScriptForTTS(scriptContent);
        this.tts.currentScriptType = scriptType;
        
        this.showVoiceControl();
        this.startSpeech();
    }

    cleanScriptForTTS(script) {
        // Remove time codes and clean up text for better TTS
        return script
            .replace(/\[\d{2}:\d{2}-\d{2}:\d{2}\]\s*/g, '') // Remove time codes
            .replace(/ì§„í–‰ì\d+:\s*/g, '') // Remove host labels
            .replace(/\n\n+/g, '\n') // Clean up multiple newlines
            .trim();
    }

    showVoiceControl() {
        document.getElementById('voice-control-panel').classList.remove('hidden');
        this.updateProgressDisplay();
    }

    hideVoiceControl() {
        document.getElementById('voice-control-panel').classList.add('hidden');
    }

    startSpeech() {
        if (this.tts.synth.speaking) {
            this.tts.synth.cancel();
        }
        
        this.tts.utterance = new SpeechSynthesisUtterance(this.tts.currentScript);
        
        // Get current settings
        const voiceIndex = parseInt(document.getElementById('voice-select').value) || 0;
        const rate = parseFloat(document.getElementById('voice-rate').value) || 0.9;
        const pitch = parseFloat(document.getElementById('voice-pitch').value) || 1.0;
        
        // Apply settings
        if (this.tts.voices[voiceIndex]) {
            this.tts.utterance.voice = this.tts.voices[voiceIndex];
        }
        this.tts.utterance.rate = rate;
        this.tts.utterance.pitch = pitch;
        this.tts.utterance.volume = 1.0;
        
        // Event listeners
        this.tts.utterance.onstart = () => {
            this.tts.isPlaying = true;
            this.tts.isPaused = false;
            this.startProgressTracking();
        };
        
        this.tts.utterance.onend = () => {
            this.tts.isPlaying = false;
            this.tts.isPaused = false;
            this.resetProgress();
        };
        
        this.tts.utterance.onerror = (event) => {
            console.error('Speech synthesis error:', event);
            this.tts.isPlaying = false;
            this.tts.isPaused = false;
            alert('ìŒì„± ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        };
        
        // Start speaking
        this.tts.synth.speak(this.tts.utterance);
    }

    togglePlayPause() {
        if (!this.tts.synth.speaking && !this.tts.isPaused) {
            // Start new speech
            this.startSpeech();
        } else if (this.tts.isPlaying && !this.tts.isPaused) {
            // Pause
            this.tts.synth.pause();
            this.tts.isPaused = true;
            this.tts.isPlaying = false;
        } else if (this.tts.isPaused) {
            // Resume
            this.tts.synth.resume();
            this.tts.isPaused = false;
            this.tts.isPlaying = true;
        }
    }

    stop() {
        this.tts.synth.cancel();
        this.tts.isPlaying = false;
        this.tts.isPaused = false;
        this.resetProgress();
    }

    startProgressTracking() {
        // Estimate total duration based on text length and speech rate
        const words = this.tts.currentScript.split(' ').length;
        const rate = parseFloat(document.getElementById('voice-rate').value) || 0.9;
        const estimatedDuration = (words / (150 * rate)) * 60; // 150 words per minute baseline
        
        document.getElementById('total-time').textContent = this.formatTime(estimatedDuration);
        
        // Update progress periodically
        this.progressInterval = setInterval(() => {
            if (this.tts.isPlaying && this.tts.synth.speaking) {
                // This is an approximation since Web Speech API doesn't provide precise progress
                const elapsed = (Date.now() - this.speechStartTime) / 1000;
                const progress = Math.min((elapsed / estimatedDuration) * 100, 100);
                
                document.getElementById('progress-bar').style.width = progress + '%';
                document.getElementById('current-time').textContent = this.formatTime(elapsed);
                
                if (progress >= 100) {
                    this.resetProgress();
                }
            }
        }, 100);
        
        this.speechStartTime = Date.now();
    }

    resetProgress() {
        if (this.progressInterval) {
            clearInterval(this.progressInterval);
        }
        document.getElementById('progress-bar').style.width = '0%';
        document.getElementById('current-time').textContent = '00:00';
    }

    updateProgressDisplay() {
        document.getElementById('current-time').textContent = '00:00';
        document.getElementById('total-time').textContent = '00:00';
        document.getElementById('progress-bar').style.width = '0%';
    }

    formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
}

// Initialize app when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    window.aieodingApp = new AIeodingApp();
});
</script>

</body>
</html>
